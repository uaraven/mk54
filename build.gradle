group 'net.ninjacat'
version '0.1'

apply plugin: 'java'
apply plugin: 'idea'
apply plugin: 'com.github.johnrengelman.shadow'

buildscript {
    repositories {
        jcenter()
    }
    dependencies {
        classpath 'com.github.jengelman.gradle.plugins:shadow:2.0.4'
    }
}

sourceCompatibility = 1.8

repositories {
    mavenCentral()
}

task createProperties(dependsOn: processResources) {
    doLast {
        new File("$buildDir/resources/main/version.properties").withWriter { final w ->
            final Properties p = new Properties()
            p['version'] = project.version.toString()
            p.store w, null
        }
    }
}

compileJava {
    dependsOn createProperties
}


jar {
    manifest {
        attributes 'Main-Class': 'net.ninjacat.mk54.Mk54CodeGenerator'
    }
}

dependencies {
    compile 'org.ow2.asm:asm:6.2'
    compile group: 'com.fasterxml.jackson.core', name: 'jackson-databind', version: '2.0.1'
    compile group: 'com.google.guava', name: 'guava', version: '25.1-jre'
    compile group: 'com.beust', name: 'jcommander', version: '1.72'

    testCompile group: 'junit', name: 'junit', version: '4.12'
    testCompile group: 'org.hamcrest', name: 'hamcrest-all', version: '1.3'

}
